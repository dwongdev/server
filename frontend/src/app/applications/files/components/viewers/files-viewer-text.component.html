<!--
  ~ Copyright (C) 2012-2025 Johan Legrand <johan.legrand@sync-in.com>
  ~ This file is part of Sync-in | The open source file sync and share solution
  ~ See the LICENSE file for licensing details
  -->

<div [style.height.px]="currentHeight()">
  <div class="app-top-menu">
    <button
      (click)="toggleReadonly()"
      [tooltip]="(isReadonly() || !isWriteable() ? 'Read-only' : 'Read-write') | translate:locale.language"
      [adaptivePosition]="true"
      class="btn btn-sm btn-secondary me-1"
      type="button"
      [disabled]="!isSupported() || !isWriteable()">
      <fa-icon [icon]="isReadonly() ? icons.faLock : icons.faLockOpen"></fa-icon>
    </button>
    <button
      (click)="save()"
      [tooltip]="(isReadonly() || !isWriteable() || !isModified() ? undefined : 'Save') | translate:locale.language"
      [isDisabled]="isReadonly() || !isWriteable() || !isModified()"
      class="btn btn-sm btn-secondary me-1"
      type="button"
      [disabled]="isReadonly() || !isWriteable() || !isModified()">
      @if (isSaving()) {
        <fa-icon [icon]="icons.faSpinner" animation="spin"></fa-icon>
      } @else {
        <fa-icon [icon]="icons.faFloppyDisk"></fa-icon>
      }
    </button>
    <button
      (click)="onUndo()"
      [disabled]="!canUndo()"
      [tooltip]="'Undo' | translate:locale.language"
      class="d-none d-sm-block btn btn-sm btn-custom me-1"
      type="button">
      <fa-icon [icon]="icons.faReply"></fa-icon>
    </button>
    <button
      (click)="onRedo()"
      [disabled]="!canRedo()"
      [tooltip]="'Redo' | translate:locale.language"
      class="d-none d-sm-block btn btn-sm btn-custom me-1"
      type="button">
      <fa-icon [icon]="icons.faShare"></fa-icon>
    </button>
    <button
      btnCheckbox
      [ngModel]="lineWrapping()"
      (ngModelChange)="lineWrapping.set($event)"
      [tooltip]="'Line Wrap' | translate:locale.language"
      class="d-none d-sm-block btn btn-sm btn-custom me-1"
      type="button">
      <fa-icon [icon]="icons.faArrowsLeftRightToLine"></fa-icon>
    </button>
    <button
      btnCheckbox
      [ngModel]="isSearchPanelOpen()"
      (ngModelChange)="toggleSearch()"
      [tooltip]="'Search' | translate:locale.language"
      class="d-none d-sm-block btn btn-sm btn-custom"
      type="button">
      <fa-icon [icon]="icons.faMagnifyingGlass"></fa-icon>
    </button>
    @if (warnOnUnsavedChanges()) {
      <button (click)="save(true)"
              class="btn btn-sm btn-primary me-2 ms-auto"
              type="button"
              l10nTranslate>Save And Exit
      </button>
      <button (click)="onClose()"
              class="btn btn-sm btn-danger me-2"
              data-dismiss="modal" type="button"
              l10nTranslate>Close Without Saving
      </button>
      <button (click)="warnOnUnsavedChanges.set(false)"
              class="d-none d-sm-block btn btn-sm btn-secondary"
              data-dismiss="modal" type="button"
              l10nTranslate>Cancel
      </button>
    }
  </div>
  <code-editor
    #editor
    [autoFocus]="true"
    [languages]="languages"
    [language]="currentLanguage"
    [(ngModel)]="content"
    (change)="contentChange()"
    [theme]="currentTheme"
    [readonly]="isReadonly()"
    [disabled]="isReadonly()"
    [lineWrapping]="lineWrapping()" />
</div>
